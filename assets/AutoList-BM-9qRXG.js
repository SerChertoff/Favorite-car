import{d as S,r as s,m as I,n as P,c as r,b as e,p as T,f as V,q as c,v as g,s as C,e as $,t as _,k as i,_ as x,o as U,g as w,F as B,j as M,a as Y,l as A}from"./index-CixOLOK7.js";import{A as N}from"./AutoCard-CZpDjsbq.js";const D={class:"search-bar card"},L={class:"search-row"},j={key:0,class:"filters"},E={class:"filter-group"},Q={class:"filter-group"},q={class:"filter-group"},O=["placeholder"],z={class:"filter-group"},G={class:"filter-group"},H={class:"filter-group"},J=S({__name:"SearchBar",emits:["search"],setup(F,{emit:d}){const p=d,l=s(""),u=s(!1),m=I(()=>new Date().getFullYear()),a=P({minPrice:void 0,maxPrice:void 0,minYear:void 0,bodyType:void 0,fuelType:void 0,transmission:void 0});function b(){p("search",l.value,a)}function f(){p("search",l.value,a)}function n(){p("search",l.value,a)}function h(){l.value="",Object.keys(a).forEach(y=>{a[y]=void 0}),p("search","",a)}return(y,t)=>(i(),r("div",D,[e("form",{onSubmit:T(b,["prevent"]),class:"search-form"},[e("div",L,[c(e("input",{"onUpdate:modelValue":t[0]||(t[0]=o=>l.value=o),type:"text",class:"input search-input",placeholder:"Марка, модель или ключевое слово...",onInput:f},null,544),[[g,l.value]]),t[8]||(t[8]=e("button",{type:"submit",class:"btn btn-primary"},"Найти",-1))]),u.value?(i(),r("div",j,[e("div",E,[t[9]||(t[9]=e("label",null,"Цена от",-1)),c(e("input",{"onUpdate:modelValue":t[1]||(t[1]=o=>a.minPrice=o),type:"number",class:"input",placeholder:"0",onInput:n},null,544),[[g,a.minPrice,void 0,{number:!0}]])]),e("div",Q,[t[10]||(t[10]=e("label",null,"Цена до",-1)),c(e("input",{"onUpdate:modelValue":t[2]||(t[2]=o=>a.maxPrice=o),type:"number",class:"input",placeholder:"∞",onInput:n},null,544),[[g,a.maxPrice,void 0,{number:!0}]])]),e("div",q,[t[11]||(t[11]=e("label",null,"Год от",-1)),c(e("input",{"onUpdate:modelValue":t[3]||(t[3]=o=>a.minYear=o),type:"number",class:"input",placeholder:String(m.value-20),onInput:n},null,40,O),[[g,a.minYear,void 0,{number:!0}]])]),e("div",z,[t[13]||(t[13]=e("label",null,"Тип кузова",-1)),c(e("select",{"onUpdate:modelValue":t[4]||(t[4]=o=>a.bodyType=o),class:"input",onChange:n},[...t[12]||(t[12]=[$('<option value="" data-v-34071467>Все</option><option value="седан" data-v-34071467>Седан</option><option value="хэтчбек" data-v-34071467>Хэтчбек</option><option value="универсал" data-v-34071467>Универсал</option><option value="внедорожник" data-v-34071467>Внедорожник</option><option value="купе" data-v-34071467>Купе</option><option value="кабриолет" data-v-34071467>Кабриолет</option>',7)])],544),[[C,a.bodyType]])]),e("div",G,[t[15]||(t[15]=e("label",null,"Топливо",-1)),c(e("select",{"onUpdate:modelValue":t[5]||(t[5]=o=>a.fuelType=o),class:"input",onChange:n},[...t[14]||(t[14]=[$('<option value="" data-v-34071467>Все</option><option value="бензин" data-v-34071467>Бензин</option><option value="дизель" data-v-34071467>Дизель</option><option value="электричество" data-v-34071467>Электричество</option><option value="гибрид" data-v-34071467>Гибрид</option>',5)])],544),[[C,a.fuelType]])]),e("div",H,[t[17]||(t[17]=e("label",null,"КПП",-1)),c(e("select",{"onUpdate:modelValue":t[6]||(t[6]=o=>a.transmission=o),class:"input",onChange:n},[...t[16]||(t[16]=[$('<option value="" data-v-34071467>Все</option><option value="механика" data-v-34071467>Механика</option><option value="автомат" data-v-34071467>Автомат</option><option value="робот" data-v-34071467>Робот</option><option value="вариатор" data-v-34071467>Вариатор</option>',5)])],544),[[C,a.transmission]])]),e("button",{type:"button",onClick:h,class:"btn btn-outline"}," Сбросить ")])):V("",!0),e("button",{type:"button",onClick:t[7]||(t[7]=o=>u.value=!u.value),class:"toggle-filters"},_(u.value?"Скрыть фильтры":"Показать фильтры"),1)],32)]))}}),K=x(J,[["__scopeId","data-v-34071467"]]),R={class:"auto-list"},W={class:"container"},X={key:0,class:"loading"},Z={key:1,class:"error"},tt={key:2,class:"empty-state"},et={key:3},ot={class:"results-info"},at={class:"cars-grid"},lt={key:0,class:"pagination"},nt=["disabled"],st=S({__name:"AutoList",setup(F){const d=s([]),p=s(!1),l=s(!1),u=s(""),m=s(0),a=s(1),b=s({}),f=s("");async function n(t=1,o=!1){o?(p.value=!0,d.value=[],a.value=1):l.value=!0,u.value="";try{const v={page:t,limit:12,...b.value};f.value&&(v.search=f.value);const k=await Y.getCars(v);o?d.value=k.cars:d.value.push(...k.cars),m.value=k.total,a.value=t}catch(v){u.value="Не удалось загрузить автомобили. Попробуйте позже.",console.error(v)}finally{p.value=!1,l.value=!1}}function h(t,o){f.value=t,b.value=o,n(1,!0)}function y(){n(a.value+1,!1)}return U(()=>{n(1,!0)}),(t,o)=>(i(),r("div",R,[e("div",W,[o[1]||(o[1]=e("h1",{class:"page-title"},"Каталог автомобилей",-1)),w(K,{onSearch:h}),p.value?(i(),r("div",X," Загрузка автомобилей... ")):u.value?(i(),r("div",Z,_(u.value),1)):d.value.length===0?(i(),r("div",tt,[...o[0]||(o[0]=[e("p",null,"Автомобили не найдены",-1),e("p",null,"Попробуйте изменить параметры поиска",-1)])])):(i(),r("div",et,[e("div",ot,[e("p",null,"Найдено автомобилей: "+_(m.value),1)]),e("div",at,[(i(!0),r(B,null,M(d.value,v=>(i(),A(N,{key:v.id,car:v},null,8,["car"]))),128))]),m.value>d.value.length?(i(),r("div",lt,[e("button",{onClick:y,class:"btn btn-primary",disabled:l.value},_(l.value?"Загрузка...":"Загрузить еще"),9,nt)])):V("",!0)]))])]))}}),rt=x(st,[["__scopeId","data-v-68fa1e78"]]);export{rt as default};
